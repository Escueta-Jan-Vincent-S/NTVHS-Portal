<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NTVHS Portal - Manage Worksheets</title>
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='images/logo.png') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/manage_activity_quizzes_worksheets.css') }}">
</head>
<body>
    <div class="header">
        <div class="logo-section">
            <img src="{{ url_for('static', filename='images/logo.png') }}" alt="NTVHS Logo">
            <div class="brand-info">
                <h1>NTVHS Portal</h1>
                <p>Technical • Vocational • National</p>
            </div>
        </div>

        <div class="nav-section">
            <a href="{{ url_for('homepage') }}" class="back-btn">🏠 Back to Dashboard</a>
            <a href="{{ url_for('logout') }}" class="logout-btn">🚪 Logout</a>
        </div>
    </div>

    <div class="main-content">
        <!-- Display flash messages -->
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                <div class="flash-messages">
                    {% for category, message in messages %}
                        <div class="flash-message flash-{{ category }}">{{ message }}</div>
                    {% endfor %}
                </div>
            {% endif %}
        {% endwith %}

        <div class="page-title">
            <h2>📄 Worksheet Management</h2>
            <p>Create, manage, and distribute worksheets and practice materials for your students</p>
        </div>

        <div class="content-grid">
            <!-- Add Worksheet Form -->
            <div class="form-section">
                <h3>➕ Add New Worksheet</h3>
                <form action="{{ url_for('add_worksheet') }}" method="POST">
                    <div class="form-group">
                        <label for="name">Name of Worksheet:</label>
                        <input type="text" id="name" name="name" required placeholder="Enter worksheet name">
                    </div>

                    <div class="form-group">
                        <label for="grade">Grade:</label>
                        <select id="grade" name="grade" required>
                            <option value="">Select Grade Level</option>
                            <option value="Grade 7">Grade 7</option>
                            <option value="Grade 8">Grade 8</option>
                            <option value="Grade 9">Grade 9</option>
                            <option value="Grade 10">Grade 10</option>
                            <option value="Grade 11">Grade 11</option>
                            <option value="Grade 12">Grade 12</option>
                            <option value="ALS 11">ALS 11</option>
                            <option value="ALS 12">ALS 12</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="end_date">Date of End of Worksheet <span class="optional-label">(Optional)</span>:</label>
                        <input type="datetime-local" id="end_date" name="end_date" placeholder="Select end date and time">
                        <small class="optional-label">Leave empty if no specific end date. Worksheet will remain active until manually removed.</small>
                    </div>

                    <div class="form-group">
                        <label for="upload_link">Worksheet Link:</label>
                        <input type="url" id="upload_link" name="upload_link" required placeholder="https://drive.google.com/file/d/... or worksheet link">
                    </div>

                    <div class="form-group">
                        <label for="professor">Professor <span class="optional-label">(Optional)</span>:</label>
                        <input type="text" id="professor" name="professor" placeholder="Enter professor/teacher name">
                    </div>

                    <button type="submit" class="submit-btn">🚀 Create Worksheet</button>
                </form>
            </div>

            <!-- Worksheet List -->
            <div class="quiz-list-section">
                <h3>📋 Current Worksheets</h3>
                {% if worksheets %}
                    {% for worksheet in worksheets %}
                    <div class="quiz-item">
                        <div class="quiz-header">
                            <div>
                                <div class="quiz-title">{{ worksheet.name }}</div>
                                <span class="quiz-grade">{{ worksheet.grade }}</span>
                            </div>
                        </div>

                        <div class="quiz-details">
                            {% if worksheet.end_date %}
                                <div class="date-highlight">
                                    <span class="date-label">📅 Worksheet Expires:</span>
                                    <span class="date-value">{{ worksheet.end_date | replace('T', ' at ') }}</span>
                                </div>
                            {% else %}
                                <div class="date-highlight no-expiry">
                                    <span class="date-label">📅 Worksheet Duration:</span>
                                    <span class="date-value">No expiration date</span>
                                </div>
                            {% endif %}

                            {% if worksheet.professor %}
                                <p><strong>👨‍🏫 Professor:</strong> {{ worksheet.professor }}</p>
                            {% endif %}

                            <p><strong>🔗 Worksheet Link:</strong> <a href="{{ worksheet.upload_link }}" target="_blank" style="color: #667eea;">{{ worksheet.upload_link[:50] }}...</a></p>
                            <p><strong>📅 Created:</strong> {{ worksheet.created_at }}</p>
                        </div>

                        <div class="quiz-actions">
                            <a href="{{ worksheet.upload_link }}" target="_blank" class="btn-small btn-view">👁️ View Worksheet</a>
                            <a href="{{ url_for('edit_worksheet', worksheet_id=worksheet.id) }}" class="btn-small btn-edit">✏️ Edit</a>
                            <a href="{{ url_for('delete_worksheet', worksheet_id=worksheet.id) }}"
                               class="btn-small btn-delete"
                               onclick="return confirm('Are you sure you want to delete this worksheet?')">🗑️ Delete</a>
                        </div>
                    </div>
                    {% endfor %}
                {% else %}
                    <div class="no-quizzes">
                        <p>📄 No worksheets created yet. Use the form on the left to add your first worksheet!</p>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
</body>
</html>